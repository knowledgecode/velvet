/*
 velvet.js (c) KNOWLEDGECODE | MIT

 https://github.com/gre/bezier-easing
 BezierEasing - use bezier curve for transition easing function
 by Gaëtan Renaudeau 2014 - 2015 – MIT License
*/
(function(B){var N="animate"in Element.prototype&&!!document.createElement("div").animate([]).play,r=function(){var a="function"===typeof Float32Array,c=function(b,a,c){return(((1-3*c+3*a)*b+(3*c-6*a))*b+3*a)*b};return function(b,e,d,h){if(!(0<=b&&1>=b&&0<=d&&1>=d))throw Error("bezier x values must be in [0, 1] range");var k=a?new Float32Array(11):Array(11);if(b!==e||d!==h)for(var l=0;11>l;++l)k[l]=c(.1*l,b,d);return function(a){if(b===e&&d===h)return a;if(0===a)return 0;if(1===a)return 1;for(var f=
0,g=1;10!==g&&k[g]<=a;++g)f+=.1;--g;var g=f+(a-k[g])/(k[g+1]-k[g])*.1,n=3*(1-3*d+3*b)*g*g+2*(3*d-6*b)*g+3*b;if(.001<=n){for(f=0;4>f;++f){n=3*(1-3*d+3*b)*g*g+2*(3*d-6*b)*g+3*b;if(0===n)break;var l=c(g,b,d)-a,g=g-l/n}a=g}else if(0===n)a=g;else{var g=f,f=f+.1,p=0;do l=g+.5*(f-g),n=c(l,b,d)-a,0<n?f=l:g=l;while(1E-7<Math.abs(n)&&10>++p);a=l}return c(a,e,h)}}}(),O={ease:r(.25,.1,.25,1),linear:r(0,0,1,1),"ease-in":r(.42,0,1,1),"ease-out":r(0,0,.58,1),"ease-in-out":r(.42,0,.58,1)},G=function(a,c){var b=["webkit",
"moz","ms","o"],e=c,d,h;d=0;for(h=b.length;!(e in a)&&d<h;d++)e=b[d]+c[0].toUpperCase()+c.slice(1);return d<h?e:""},H=function(){var a=[],c=0,b=0,e=1E3/60,d=function(){var h=Date.now(),k=Math.max(e-(h-b),0);b=h+k;return c=setTimeout(function(){var b=h+k,e,f=a.length;if(f){for(e=0;e<f;e++)a[e](b);a.splice(0,f);d()}else c=0},k)};return B[G(B,"requestAnimationFrame")]||function(b){a[a.length]=b;return c||d()}}(),w=G(document.createElement("div").style,"transform"),P=function(){var a=document.createElement("div");
a.style[w]="translateZ(0)";return!!a.style[w]}(),C=function(a,c,b){b=b||Array(a.length);for(var e=0,d=a.length;e<d;e++)b[e]=c(a[e],e);return b},v=function(a,c){for(var b=0,e=a.length;b<e;b++)c(a[b],b)},t=function(a,c){for(var b=0,e=c.length,d=a.length-1,h=a[0];b<d;)h+=(b<e?c[b]:"%s")+a[++b];return h},u=function(a){this._weaver=a};u.prototype.play=function(){this._weaver.play();return this};u.prototype.pause=function(){this._weaver.pause();return this};u.prototype.finish=function(){this._weaver.finish();
return this};u.prototype.cancel=function(){this._weaver.cancel();return this};u.prototype.reverse=function(){this._weaver.reverse();return this};u.prototype.direction=function(){var a=this._weaver.playbackRate||this._weaver.direction||0;return 0<a?1:0>a?-1:0};r=function(){};r.prototype.weave=function(a,c,b,e){var d=O[b.easing||"linear"],h=b.duration||1,k=C(c,function(b,c){return b-a[c]}),l=Array(k.length),p,f,g,n=0,q=!1,m=function(b){H(function(a){f.startTime=a-n+(b||0);p(a)})};f={startTime:0,playState:2,
direction:1,cancel:function(){n=0;2===this.playState?this.playState=0:(this.playState=0,m())},pause:function(){2===this.playState&&(this.playState=3)},play:function(){2!==this.playState&&(this.playState=2,m())},finish:function(){n=0;2===this.playState?this.playState=4:(this.playState=4,m())},reverse:function(){q||(this.direction=~this.direction+1);q=!0;if(2===this.playState||3===this.playState)n=h-n;2!==this.playState&&m()},oncancel:b.oncancel,onfinish:b.onfinish};g=new u(f);p=function(m){var r;q&&
(q=!q,f.playState=2,f.startTime=m-n-(b.delay||0));m-=f.startTime;if(2===f.playState){n=m;if(m<h){0<=m&&(r=d((0<f.direction?m:h-m)/h),e(C(k,function(b,c){return a[c]+b*r},l)));H(p);return}f.playState=4}3!==f.playState&&(0===f.playState?(e(a),f.oncancel&&f.oncancel.bind(g)()):(e(~f.direction?c:a),n=0,f.onfinish&&f.onfinish.bind(g)()))};m(b.delay);return g};var I="translateX translateY translateZ scale scaleX scaleY scaleZ rotate rotateX rotateY rotateZ skewX skewY perspective".split(" "),Q="px px px     deg deg deg deg deg deg px".split(" "),
R=[0,0,0,1,1,1,1,0,0,0,0,0,0,0],D=function(){var a={},c=["","(","",")"];v(I,function(b,e){a[b]=t(c,[b,"%s",Q[e]])});return a}(),J=function(){var a={};v(I,function(c,b){a[c]=R[b]});return a}(),E={opacity:"%s"},K={opacity:1},z=function(a,c){var b=Object.keys(a).slice();v(Object.keys(c),function(a){~b.indexOf(a)||(b[b.length]=a)});return b},L=function(a,c,b,e){v(Object.keys(a),function(d){d in D?c[d]=a[d]:d in E?b[d]=a[d]:e[d]=a[d]})},A=function(a,c){var b="";v(a,function(a){b+=" "+c[a]});return b.trim().split("%s")},
m=function(a,c,b){return C(a,function(a){return a in c?c[a]:b[a]})},x=function(a,c,b){var e={};v(a,function(a){e[a]=a in c?c[a]:b[a]});return e},y=function(a){this.element=a;this.transforms={};this.opacity={}};y.prototype=new r;y.prototype.constructor=y;var M=new r;y.prototype.weave=function(a,c){var b={},e={},d,h,k,l,p={},f={},g=[],n=[],q;L(a,b,e,{});d=z(this.transforms,b);h=z(this.opacity,e);k=A(d,D);k.length&&P&&(k[k.length-1]+=" translateZ(0)");l=A(h,E);N?(k.length&&(p[w]=t(k,m(d,this.transforms,
J)),f[w]=t(k,m(d,b,this.transforms))),l.length&&(p.opacity=t(l,m(h,this.opacity,K)),f.opacity=t(l,m(h,e,this.opacity))),p=this.element.animate([p,f],{delay:c.delay||0,duration:c.duration||0,easing:c.easing||"linear",fill:"both"}),q=new u(p),p.oncancel=function(){c.oncancel&&c.oncancel.bind(q)()},p.onfinish=function(){this.transforms=x(d,b,this.transforms);this.opacity=x(h,e,this.opacity);c.onfinish&&c.onfinish.bind(q)()}.bind(this)):(k&&(g=m(d,this.transforms,J),n=m(d,b,this.transforms)),l&&(g=g.concat(m(h,
this.opacity,K)),n=n.concat(m(h,e,this.opacity))),q=M.weave(g,n,{delay:c.delay,duration:c.duration,easing:c.easing,oncancel:function(){c.oncancel&&c.oncancel.bind(q)()},onfinish:function(){this.transforms=x(d,b,this.transforms);this.opacity=x(h,e,this.opacity);c.onfinish&&c.onfinish.bind(q)()}.bind(this)},function(a){var b=this.element.style;k.length&&(b[w]=t(k,a));l.length&&(b.opacity=t(l,[a[a.length-1]]))}.bind(this)));return q};y.prototype.style=function(a){var c={},b={},e={},d,h,k,l=this.element.style;
L(a,c,b,e);a=z(this.transforms,c);d=z(this.opacity,b);h=A(a,D);k=A(d,E);v(Object.keys(e),function(a){l[a]=e[a]});h.length&&(l[w]=t(h,m(a,c,this.transforms)));k.length&&(l.opacity=t(k,m(d,b,this.opacity)));this.transforms=x(a,c,this.transforms);this.opacity=x(d,b,this.opacity);return this};var F=function(a){return a?new y(a):M};"object"===typeof module&&"object"===typeof module.exports?module.exports=F:"function"===typeof define&&define.amd?define([],function(){return F}):B.velvet=F})(this);
