/*
 velvet.js (c) KNOWLEDGECODE | MIT

 https://github.com/gre/bezier-easing
 BezierEasing - use bezier curve for transition easing function
 by Gaëtan Renaudeau 2014 - 2015 – MIT License
*/
(function(C){var O=!!document.createElement("div").animate,t=function(){var a="function"===typeof Float32Array,c=function(b,a,c){return(((1-3*c+3*a)*b+(3*c-6*a))*b+3*a)*b};return function(b,e,d,g){if(!(0<=b&&1>=b&&0<=d&&1>=d))throw Error("bezier x values must be in [0, 1] range");var k=a?new Float32Array(11):Array(11);if(b!==e||d!==g)for(var l=0;11>l;++l)k[l]=c(.1*l,b,d);return function(a){if(b===e&&d===g)return a;if(0===a)return 0;if(1===a)return 1;for(var f=0,h=1;10!==h&&k[h]<=a;++h)f+=.1;--h;var h=
f+(a-k[h])/(k[h+1]-k[h])*.1,m=3*(1-3*d+3*b)*h*h+2*(3*d-6*b)*h+3*b;if(.001<=m){for(f=0;4>f;++f){m=3*(1-3*d+3*b)*h*h+2*(3*d-6*b)*h+3*b;if(0===m)break;var l=c(h,b,d)-a,h=h-l/m}a=h}else if(0===m)a=h;else{var h=f,f=f+.1,n=0;do l=h+.5*(f-h),m=c(l,b,d)-a,0<m?f=l:h=l;while(1E-7<Math.abs(m)&&10>++n);a=l}return c(a,e,g)}}}(),P={ease:t(.25,.1,.25,1),linear:t(0,0,1,1),"ease-in":t(.42,0,1,1),"ease-out":t(0,0,.58,1),"ease-in-out":t(.42,0,.58,1)},H=function(a,c){var b=["webkit","moz","ms","o"],e=c,d,g;d=0;for(g=
b.length;!(e in a)&&d<g;d++)e=b[d]+c[0].toUpperCase()+c.slice(1);return d<g?e:""},I=function(){var a=[],c=0,b=0,e=1E3/60,d=function(){var g=Date.now(),k=Math.max(e-(g-b),0);b=g+k;return c=setTimeout(function(){var b=g+k,e,f=a.length;if(f){for(e=0;e<f;e++)a[e](b);a=a.splice(f);d()}else c=0},k)};return C[H(C,"requestAnimationFrame")]||function(b){a[a.length]=b;return c||d()}}(),x=H(document.createElement("div").style,"transform"),Q=function(){var a=document.createElement("div");a.style[x]="translateZ(0)";
return!!a.style[x]}(),D=function(a,c,b){b=b||Array(a.length);for(var e=0,d=a.length;e<d;e++)b[e]=c(a[e],e);return b},w=function(a,c){for(var b=0,e=a.length;b<e;b++)c(a[b],b)},u=function(a,c){for(var b=0,e=c.length,d=a.length-1,g=a[0];b<d;)g+=(b<e?c[b]:"%s")+a[++b];return g},v=function(a){this._weaver=a};v.prototype.play=function(){this._weaver.play();return this};v.prototype.pause=function(){this._weaver.pause();return this};v.prototype.finish=function(){this._weaver.finish();return this};v.prototype.cancel=
function(){this._weaver.cancel();return this};v.prototype.reverse=function(){this._weaver.reverse();return this};v.prototype.direction=function(){var a=this._weaver.playbackRate||this._weaver.direction||0;return 0<a?1:0>a?-1:0};t=function(){};t.prototype.weave=function(a,c,b,e){var d=P[b.easing||"linear"],g=b.duration||1,k=D(c,function(b,c){return b-a[c]}),l=Array(k.length),r,f,h,m=0,p=!1,n=function(b){I(function(a){f.startTime=a-m+(b||0);r(a)})};f={startTime:0,playState:2,direction:1,cancel:function(){m=
0;2===this.playState?this.playState=0:(this.playState=0,n())},pause:function(){2===this.playState&&(this.playState=3)},play:function(){2!==this.playState&&(this.playState=2,n())},finish:function(){m=0;2===this.playState?this.playState=4:(this.playState=4,n())},reverse:function(){p||(this.direction=~this.direction+1);p=!0;if(2===this.playState||3===this.playState)m=g-m;2!==this.playState&&n()},oncancel:b.oncancel,onfinish:b.onfinish};h=new v(f);r=function(n){var q;p&&(p=!p,f.playState=2,f.startTime=
n-m-(b.delay||0));n-=f.startTime;if(2===f.playState){m=n;if(n<g){0<=n&&(q=d((0<f.direction?n:g-n)/g),e(D(k,function(b,c){return a[c]+b*q},l)));I(r);return}f.playState=4}3!==f.playState&&(0===f.playState?(e(a),f.oncancel&&f.oncancel.bind(h)()):(e(~f.direction?c:a),m=0,f.onfinish&&f.onfinish.bind(h)()))};n(b.delay);return h};var J="translateX translateY translateZ scale scaleX scaleY scaleZ rotate rotateX rotateY rotateZ skewX skewY perspective".split(" "),R="px px px     deg deg deg deg deg deg px".split(" "),
S=[0,0,0,1,1,1,1,0,0,0,0,0,0,0],E=function(){var a={},c=["","(","",")"];w(J,function(b,e){a[b]=u(c,[b,"%s",R[e]])});return a}(),K=function(){var a={};w(J,function(c,b){a[c]=S[b]});return a}(),F={opacity:"%s"},L={opacity:1},A=function(a,c){var b=Object.keys(a).slice();w(Object.keys(c),function(a){~b.indexOf(a)||(b[b.length]=a)});return b},M=function(a,c,b,e){w(Object.keys(a),function(d){d in E?c[d]=a[d]:d in F?b[d]=a[d]:e[d]=a[d]})},B=function(a,c){var b="";w(a,function(a){b+=" "+c[a]});return b.trim().split("%s")},
q=function(a,c,b){return D(a,function(a){return a in c?c[a]:b[a]})},y=function(a,c,b){var e={};w(a,function(a){e[a]=a in c?c[a]:b[a]});return e},z=function(a){this.element=a;this.transforms={};this.opacity={}};z.prototype=new t;z.prototype.constructor=z;var N=new t;z.prototype.weave=function(a,c){var b={},e={},d,g,k,l,r={},f={},h=[],m=[],p;M(a,b,e,{});d=A(this.transforms,b);g=A(this.opacity,e);k=B(d,E);k.length&&Q&&(k[k.length-1]+=" translateZ(0)");l=B(g,F);O?(k.length&&(r[x]=u(k,q(d,this.transforms,
K)),f[x]=u(k,q(d,b,this.transforms))),l.length&&(r.opacity=u(l,q(g,this.opacity,L)),f.opacity=u(l,q(g,e,this.opacity))),r=this.element.animate([r,f],{delay:c.delay||0,duration:c.duration||0,easing:c.easing||"linear",fill:"both"}),p=new v(r),r.oncancel=function(){c.oncancel&&c.oncancel.bind(p)()},r.onfinish=function(){this.transforms=y(d,b,this.transforms);this.opacity=y(g,e,this.opacity);c.onfinish&&c.onfinish.bind(p)()}.bind(this)):(k&&(h=q(d,this.transforms,K),m=q(d,b,this.transforms)),l&&(h=h.concat(q(g,
this.opacity,L)),m=m.concat(q(g,e,this.opacity))),p=N.weave(h,m,{delay:c.delay,duration:c.duration,easing:c.easing,oncancel:function(){c.oncancel&&c.oncancel.bind(p)()},onfinish:function(){this.transforms=y(d,b,this.transforms);this.opacity=y(g,e,this.opacity);c.onfinish&&c.onfinish.bind(p)()}.bind(this)},function(a){var b=this.element.style;k.length&&(b[x]=u(k,a));l.length&&(b.opacity=u(l,[a[a.length-1]]))}.bind(this)));return p};z.prototype.style=function(a){var c={},b={},e={},d,g,k,l=this.element.style;
M(a,c,b,e);a=A(this.transforms,c);d=A(this.opacity,b);g=B(a,E);k=B(d,F);w(Object.keys(e),function(a){l[a]=e[a]});g.length&&(l[x]=u(g,q(a,c,this.transforms)));k.length&&(l.opacity=u(k,q(d,b,this.opacity)));this.transforms=y(a,c,this.transforms);this.opacity=y(d,b,this.opacity);return this};var G=function(a){return a?new z(a):N};"object"===typeof module&&"object"===typeof module.exports?module.exports=G:"function"===typeof define&&define.amd?define([],function(){return G}):C.velvet=G})(this);
